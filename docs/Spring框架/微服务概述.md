微服务概述



## 什么是微服务

微服务的本质是拆分。将单体应用按业务边界拆分为多个独立部署、独立开发的小型服务。

将一个大型单体应用按照模块拆分为多个小的服务应用，服务间通过HTTP接口通信，对外通过 Nginx 反向代理统一入口来代替原单体应用的对外入口。这就是一个简单的微服务架构。





## 什么是服务治理（微服务架构）

很显然，上述这种简单的微服务架构比较原始，容易出错。所以需要一种标准化的控制机制，来解决这个问题。这种“控制机制”，就被称为服务治理。

服务治理的实现方式有两种：

- **SDK 模式**：直接在业务应用中引入治理框架的SDK类库，将治理逻辑嵌入到业务代码中。（侵入式）
- **Service Mesh 模式**：将治理能力下沉到独立的代理层（如 Istio + Envoy），业务服务与治理组件解耦，通过 Sidecar 代理处理所有网络通信（**非侵入式**）

**Spring Cloud** 的实现是第一种（SDK 类库模式）。

第二种的介绍文档：[Service Mesh:下一代微服务 · awesome-servicemesh](https://servicemesh.gitbooks.io/awesome-servicemesh/content/mesh/2017/service-mesh-next-generation-of-microservice/)

> 将一个大型的单体应用拆分为多个小的服务应用，最简单的方式就是通过HTTP接口通信来进行服务之前的通信，通过nginx来反向代理到各个服务来代替以往的单体应用对外接口。这就是一个简单的微服务，但是这种方式比较原始而且容易出错，所以需要一个标准化的架构来控制整个微服务，这个架构就是服务治理，Spring Cloud就是这样一种服务治理的架构，它采用类库SDK形式嵌入到每个微服务中去来控制整个微服务。





## 服务治理的功能：

如何解决微服务中出现的各种问题，抽象出了服务治理的各种功能。

服务治理的功能，就是从微服务实践中**抽象出的“问题驱动型”解决方案集合**。

- **服务注册与发现**：避免微服务间的强耦合IP地址，解耦服务的调用方和提供方，实现动态伸缩等功能
- **负载均衡**：避免单个服务实例因请求集中而过载
- **熔断与降级**：防止因某个服务故障引发连锁反应，避免系统雪崩
- **限流与流控**：防止突发流量或恶意请求压垮服务，保障系统稳定性
- **容错与重试**：应对网络抖动或临时故障，提升服务调用的可靠性
- **配置管理**：解决配置分散、修改需重启的问题，实现配置动态更新
- **链路追踪**：解决调用链路过长、问题难定位的问题，提升系统可观测性





## 微服务与分布式系统的区别

**微服务**是一种软件架构风格，目的是将一个大型应用拆分为多个小型、独立部署、松耦合的服务。

**分布式系统**是一个更为宏观的概念，多个独立的节点通过网络通信，共同完成任务，对外表现为一个统一的系统。



**区别与联系**：所有的微服务系统都是分布式系统，但并非所有分布式系统都是微服务。

分布式系统还有如下的例子：**单体业务应用的集群部署**，MySQL Cluster，Redis Cluster，分布式文件系统（如 HDFS），区块链网络，Hadoop 大数据处理平台。



**分布式系统需要解决的问题：**分布式系统本质上是在“不可靠”的基础设施上构建“可靠”的服务，不可靠的基础设施包括通信异常，网络分区，节点故障，依赖全局时钟，并发冲突等等。

- 数据一致性（CAP定理，共识算法）
- 分布式事务
- 服务协调
- 等等等







END